### 使用するプロジェクト

この回はゲーム制作編第12回終了時点のプロジェクトを使用します。

[ゲーム制作編第12回のプロジェクトファイルをダウンロード](../game/project/game_12_ShootingGame.zip)

<span id="h1-1"></span>1.1　ゲームビューの画面サイズ変更
--------------------------------------------------------

まず`File → Project Settings...`{.inline-code}で**Platform**をAndroidまたはiOSに変更しましょう。今回はAndroidへ変更を行います。



![](images/01/switch_android.png)



次にゲームビューの画面サイズを**16:10 Landscape (16:10)**にしましょう。



![](images/01/change_screen_size.png)



図1.1のように青色の背景が見えていたら正常です。



![カメラの見える範囲が広くなった状態](images/01/screen_1.png)
<br/>図1.1: カメラの見える範囲が広くなった状態



<span id="h1-2"></span>1.2　黒帯の追加
--------------------------------------

### <span id="h1-2-1"></span>黒帯のテクスチャをインポート

今回は画面サイズの変更によって発生した「余白」を黒帯で隠すようにします。

#### 黒帯で使用するテクスチャのダウンロード

今回は4x4の黒のテクスチャを使用します。

[黒のテクスチャをダウンロード
(右クリックして保存)](./project/blackScreen.png)

ダウンロードした**blackScreen.png**のテクスチャを**Sprites**フォルダ下にインポートします。



![](images/01/imported_black_texture.png)



**Pixels To Unitsを4にします。**



![](images/01/edit_pixel_to_units.png)



### <span id="h1-2-2"></span>黒帯の設置



![完成図](images/01/completed_black_screen.png)
<br/>図1.2: 完成図



**blackScreen**をシーンビューへドラッグ＆ドロップします。



![](images/01/drag_black_screen.png)



作成された**blackScreen**ゲームオブジェクトのTransformを図1.3の値に変更します。



![Positionが（ 5, 0, 0 ）Scaleが（ 2, 6, 1
）](images/01/edit_transform_1.png)
<br/>図1.3: Positionが（ 5, 0, 0 ）Scaleが（ 2, 6, 1 ）



右側のblackScreenが設置できたので今度は左側を設置していきます。ヒエラルキービューの**blackScreen**ゲームオブジェクトを右クリックして**Duplicate**を選択して複製します。



![](images/01/duplicate.png)



複製した**blackScreen**ゲームオブジェクトのTransformを図1.4の値に変更します。



![Positionが（ -5, 0, 0 ）Scaleが（ 2, 6, 1
）](images/01/edit_transform_2.png)
<br/>図1.4: Positionが（ -5, 0, 0 ）Scaleが（ 2, 6, 1 ）



これで黒帯の設置が終わりました。



![](images/01/finish_blackscreen.png)



### <span id="h1-2-3"></span>黒帯のソーティングレイヤーを設定する

黒帯の設置は出来ましたが、このままではプレイヤーの表示が図1.5のように黒帯の上に表示されてしまいます。



![わかりづらいがプレイヤーの半分が黒帯の上に表示されている](images/01/bad_sorting_layer.png)
<br/>図1.5: わかりづらいがプレイヤーの半分が黒帯の上に表示されている



どちらかの**blackScreen**ゲームオブジェクトを選択して**Sorting
Layer**から**Add Sorting Layer...**を選択しましょう。



![](images/01/selected_add_sorting_layer.png)



そして**BlackScreen**レイヤーを追加します。順番は必ず一番下にしてください。



![](images/01/added_blackscreen_layer.png)



それぞれの**blackScreen**ゲームオブジェクトの**Sorting
LayerをBlackScreen**に変更します。



![](images/01/changed_sorting_layer.png)



これでプレイヤーが黒帯の下に隠れるようになりました。



![](images/01/finished_sorting_layer.png)



<span id="h1-3"></span>1.3　プレイヤーの移動制限
------------------------------------------------

[ゲーム制作編
第09回](../game/09.html)ではプレイヤーの移動制限をViewPortによって行いました。ですが今回は余計な部分を黒帯で表示しているので移動は黒帯の部分まで行えてしまいます。

そこで今回は**背景が表示されている範囲**のみを移動できるようにします。

StartメソッドでBackgroundコンポーネントの取得とMoveメソッドの中身を修正していきます。



Player.cs

``` {.source}
using UnityEngine;
using System.Collections;

public class Player : MonoBehaviour
{
        // Spaceshipコンポーネント
        Spaceship spaceship;

        // Backgroundコンポーネント
        Background background;

        IEnumerator Start ()
        {
                // Spaceshipコンポーネントを取得
                spaceship = GetComponent<Spaceship> ();

                // Backgroundコンポーネントを取得。3つのうちどれか1つを取得する
                background = FindObjectOfType<Background> ();

                while (true) {

                        // 弾をプレイヤーと同じ位置/角度で作成
                        spaceship.Shot (transform);

                        // ショット音を鳴らす
                        audio.Play ();

                        // shotDelay秒待つ
                        yield return new WaitForSeconds (spaceship.shotDelay);
                }
        }

        void Update ()
        {
                // 右・左
                float x = Input.GetAxisRaw ("Horizontal");

                // 上・下
                float y = Input.GetAxisRaw ("Vertical");

                // 移動する向きを求める
                Vector2 direction = new Vector2 (x, y).normalized;

                // 移動の制限
                Move (direction);

        }

        // 機体の移動
        void Move (Vector3 direction)
        {
                // 背景のスケール
                Vector2 scale = background.transform.localScale;

                // 背景のスケールから取得
                Vector2 min = scale * -0.5f;

                // 背景のスケールから取得
                Vector2 max = scale * 0.5f;

                // プレイヤーの座標を取得
                Vector3 pos = transform.position;

                // 移動量を加える
                pos += direction * spaceship.speed * Time.deltaTime;

                // プレイヤーの位置が画面内に収まるように制限をかける
                pos.x = Mathf.Clamp (pos.x, min.x, max.x);
                pos.y = Mathf.Clamp (pos.y, min.y, max.y);

                // 制限をかけた値をプレイヤーの位置とする
                transform.position = pos;
        }

        // ぶつかった瞬間に呼び出される
        void OnTriggerEnter2D (Collider2D c)
        {
                // レイヤー名を取得
                string layerName = LayerMask.LayerToName (c.gameObject.layer);

                // レイヤー名がBullet (Enemy)の時は弾を削除
                if (layerName == "Bullet (Enemy)") {
                        // 弾の削除
                        Destroy (c.gameObject);
                }

                // レイヤー名がBullet (Enemy)またはEnemyの場合は爆発
                if (layerName == "Bullet (Enemy)" || layerName == "Enemy") {
                        // Managerコンポーネントをシーン内から探して取得し、GameOverメソッドを呼び出す
                        FindObjectOfType<Manager> ().GameOver ();

                        // 爆発する
                        spaceship.Explosion ();

                        // プレイヤーを削除
                        Destroy (gameObject);
                }
        }
}
```



これでプレイヤーは背景内のみ移動できるようになりました。

### 第01回終わり

今回はここで終了です。つまずいてしまった方はプロジェクトファイルをダウンロードして新たな気持ちで次の回へ進みましょう。

[今回のプロジェクトファイルをダウンロード](./project/mobile_01_ShootingGame.zip)
